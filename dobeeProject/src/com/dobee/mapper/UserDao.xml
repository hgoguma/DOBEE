<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dobee.dao.UserDao">
	
	<!--  -->
	<select id="getUserList" resultType="com.dobee.vo.member.User">
		SELECT MAIL, NAME, MYPIC, AUTHCODE, TEAMCODE 
		FROM USER
	</select>
	
	<!-- User 정보 가져오기 -->
	<select id="getUser" resultType="com.dobee.vo.member.User">
		SELECT MAIL, PASSWORD, NAME, MYPIC, AUTHCODE FROM USER WHERE MAIL=#{mail}
	</select>
	
	
	<!-- UserInfo 정보가져오기 -->
	<select id="getUserInfoList" resultType="com.dobee.vo.member.UserInfo">
		SELECT MAIL, REGDATE, SERVE, EMP, POSITION, PHONE FROM USERINFO
	</select>
	
	
	<!-- 신청코드 불러오기 -->
	<select id="getApyCode" resultType="com.dobee.vo.ApplyCode">
		SELECT APYCODE, ENTRY FROM APPLYCODE
	</select>
	
		
	<!-- 결재자 불러오귀 // AUTHCODE=1 팀장 -->
	<select id="getApprovalList" resultType="com.dobee.vo.member.User">
		SELECT MAIL, NAME FROM USER WHERE AUTHCODE=1
	</select>
	
	
	<!-- 연장근무 년도 불러오기 -->
	<select id="overTimeYearList" resultType="Integer">
		SELECT DISTINCT DATE_FORMAT(ATTTIME, '%Y') FROM ATTEND
	</select>
	
	
	<!-- 연장근무 월 불러오기 -->
	<select id="overTimeMonthList" resultType="Integer">
		SELECT DISTINCT DATE_FORMAT(ATTTIME, '%c') FROM ATTEND;
	</select>
	
	
	<!-- 연장근무 신청하기 0112 -->
	<insert id="overTimeApply" parameterType="com.dobee.vo.Apply">
		INSERT INTO APPLY (REQDATE, REASON, STARTAT, ENDAT, ISAUTH, DRAFTER, APPROVAL, APYCODE)
			VALUES (CURDATE(), #{reason}, #{startAt}, #{endAt}, '미승인', #{drafter}, #{approval}, 6)
	</insert>
		
	
	<!-- 부재 신청하기 0112 -->
	<insert id="absApply" parameterType="com.dobee.vo.Apply">
		INSERT INTO APPLY (REQDATE, REASON, STARTAT, ENDAT, ISAUTH, DRAFTER, APPROVAL, APYCODE)
			VALUES (CURDATE(), #{reason}, #{startAt}, #{endAt}, '미승인', #{drafter}, #{approval}, #{apyCode})
	</insert>
	
</mapper>